<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Adaptive best subset selection (for generalized linear model) — abess.default • abess</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Adaptive best subset selection (for generalized linear model) — abess.default"><meta property="og:description" content="Adaptive best-subset selection for regression,
(multi-class) classification, counting-response, censored-response,
positive response, multi-response modeling in polynomial times."><meta property="og:image" content="https://abess-team.github.io/abess/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">abess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/v01-abess-guide.html">Quick start for `abess`: Linear regression</a>
    </li>
    <li>
      <a href="../articles/v03-classification.html">Classification: Logistic Regression and Multinomial Extension</a>
    </li>
    <li>
      <a href="../articles/v04-PoissonGammaReg.html">Positive response: Poisson and Gamma regression</a>
    </li>
    <li>
      <a href="../articles/v05-coxreg.html">Best Subset Selection for Censored Response</a>
    </li>
    <li>
      <a href="../articles/v06-MultiTaskLearning.html">Multi-Response Linear Regression</a>
    </li>
    <li>
      <a href="../articles/v07-advancedFeatures.html">Advanced Features</a>
    </li>
    <li>
      <a href="../articles/v08-sPCA.html">Principal component analysis</a>
    </li>
    <li>
      <a href="../articles/v09-fasterSetting.html">Tips for faster computation</a>
    </li>
    <li>
      <a href="../articles/v10-algorithm.html">ABESS algorithm: details</a>
    </li>
    <li>
      <a href="../articles/v11-power-of-abess.html">Power of abess</a>
    </li>
    <li>
      <a href="../articles/v12-Robust-Principal-Component-Analysis.html">Robust Principal Component Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/abess-team/abess/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Adaptive best subset selection (for generalized linear model)</h1>
    <small class="dont-index">Source: <a href="https://github.com/abess-team/abess/tree/master/R-package/R/abess.R" class="external-link"><code>R/abess.R</code></a></small>
    <div class="hidden name"><code>abess.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Adaptive best-subset selection for regression,
(multi-class) classification, counting-response, censored-response,
positive response, multi-response modeling in polynomial times.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for default</span></span>
<span><span class="fu">abess</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"binomial"</span>, <span class="st">"poisson"</span>, <span class="st">"cox"</span>, <span class="st">"mgaussian"</span>, <span class="st">"multinomial"</span>,</span>
<span>    <span class="st">"gamma"</span>, <span class="st">"ordinal"</span><span class="op">)</span>,</span>
<span>  tune.path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sequence"</span>, <span class="st">"gsection"</span><span class="op">)</span>,</span>
<span>  tune.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gic"</span>, <span class="st">"ebic"</span>, <span class="st">"bic"</span>, <span class="st">"aic"</span>, <span class="st">"cv"</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  c.max <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  support.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gs.range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  always.include <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group.index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  init.active.set <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  splicing.type <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max.splicing.iter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  screening.num <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  important.search <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  warm.start <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  foldid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cov.update <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  newton <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exact"</span>, <span class="st">"approx"</span><span class="op">)</span>,</span>
<span>  newton.thresh <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  max.newton.iter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  early.stop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ic.scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num.threads <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">abess</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Input matrix, of dimension \(n \times p\); each row is an observation
vector and each column is a predictor/feature/variable.
Can be in sparse matrix format (inherit from class <code>"dgCMatrix"</code> in package <code>Matrix</code>).</p></dd>


<dt>y</dt>
<dd><p>The response variable, of <code>n</code> observations.
For <code>family = "binomial"</code> should have two levels.
For <code>family="poisson"</code>, <code>y</code> should be a vector with positive integer.
For <code>family = "cox"</code>, <code>y</code> should be a <code>Surv</code> object returned
by the <code>survival</code> package (recommended) or
a two-column matrix with columns named <code>"time"</code> and <code>"status"</code>.
For <code>family = "mgaussian"</code>, <code>y</code> should be a matrix of quantitative responses.
For <code>family = "multinomial"</code> or <code>"ordinal"</code>, <code>y</code> should be a factor of at least three levels.
Note that, for either <code>"binomial"</code>, <code>"ordinal"</code> or <code>"multinomial"</code>,
if y is presented as a numerical vector, it will be coerced into a factor.</p></dd>


<dt>family</dt>
<dd><p>One of the following models:
<code>"gaussian"</code> (continuous response),
<code>"binomial"</code> (binary response),
<code>"poisson"</code> (non-negative count),
<code>"cox"</code> (left-censored response),
<code>"mgaussian"</code> (multivariate continuous response),
<code>"multinomial"</code> (multi-class response),
<code>"ordinal"</code> (multi-class ordinal response),
<code>"gamma"</code> (positive continuous response).
Depending on the response. Any unambiguous substring can be given.</p></dd>


<dt>tune.path</dt>
<dd><p>The method to be used to select the optimal support size. For
<code>tune.path = "sequence"</code>, we solve the best subset selection problem for each size in <code>support.size</code>.
For <code>tune.path = "gsection"</code>, we solve the best subset selection problem with support size ranged in <code>gs.range</code>,
where the specific support size to be considered is determined by golden section.</p></dd>


<dt>tune.type</dt>
<dd><p>The type of criterion for choosing the support size.
Available options are <code>"gic"</code>, <code>"ebic"</code>, <code>"bic"</code>, <code>"aic"</code> and <code>"cv"</code>.
Default is <code>"gic"</code>.</p></dd>


<dt>weight</dt>
<dd><p>Observation weights. When <code>weight = NULL</code>,
we set <code>weight = 1</code> for each observation as default.</p></dd>


<dt>normalize</dt>
<dd><p>Options for normalization.
<code>normalize = 0</code> for no normalization.
<code>normalize = 1</code> for subtracting the means of the columns of <code>x</code> and <code>y</code>, and also
normalizing the columns of <code>x</code> to have \(\sqrt n\) norm.
<code>normalize = 2</code> for subtracting the mean of columns of <code>x</code> and
scaling the columns of <code>x</code> to have \(\sqrt n\) norm.
<code>normalize = 3</code> for scaling the columns of <code>x</code> to have \(\sqrt n\) norm.
If <code>normalize = NULL</code>, <code>normalize</code> will be set <code>1</code> for <code>"gaussian"</code> and <code>"mgaussian"</code>,
<code>3</code> for <code>"cox"</code>. Default is <code>normalize = NULL</code>.</p></dd>


<dt>c.max</dt>
<dd><p>an integer splicing size. Default is: <code>c.max = 2</code>.</p></dd>


<dt>support.size</dt>
<dd><p>An integer vector representing the alternative support sizes.
Only used for <code>tune.path = "sequence"</code>. Default is <code>0:min(n, round(n/(log(log(n))log(p))))</code>.</p></dd>


<dt>gs.range</dt>
<dd><p>A integer vector with two elements.
The first element is the minimum model size considered by golden-section,
the later one is the maximum one. Default is <code>gs.range = c(1, min(n, round(n/(log(log(n))log(p)))))</code>.</p></dd>


<dt>lambda</dt>
<dd><p>A single lambda value for regularized best subset selection. Default is 0.</p></dd>


<dt>always.include</dt>
<dd><p>An integer vector containing the indexes of variables that should always be included in the model.</p></dd>


<dt>group.index</dt>
<dd><p>A vector of integers indicating the which group each variable is in.
For variables in the same group, they should be located in adjacent columns of <code>x</code>
and their corresponding index in <code>group.index</code> should be the same.
Denote the first group as <code>1</code>, the second <code>2</code>, etc.
If you do not fit a model with a group structure,
please set <code>group.index = NULL</code> (the default).</p></dd>


<dt>init.active.set</dt>
<dd><p>A vector of integers indicating the initial active set.
Default: <code>init.active.set = NULL</code>.</p></dd>


<dt>splicing.type</dt>
<dd><p>Optional type for splicing.
If <code>splicing.type = 1</code>, the number of variables to be spliced is
<code>c.max</code>, ..., <code>1</code>; if <code>splicing.type = 2</code>,
the number of variables to be spliced is <code>c.max</code>, <code>c.max/2</code>, ..., <code>1</code>.
(Default: <code>splicing.type = 2</code>.)</p></dd>


<dt>max.splicing.iter</dt>
<dd><p>The maximum number of performing splicing algorithm.
In most of the case, only a few times of splicing iteration can guarantee the convergence.
Default is <code>max.splicing.iter = 20</code>.</p></dd>


<dt>screening.num</dt>
<dd><p>An integer number. Preserve <code>screening.num</code> number of predictors with the largest
marginal maximum likelihood estimator before running algorithm.</p></dd>


<dt>important.search</dt>
<dd><p>An integer number indicating the number of
important variables to be splicing.
When <code>important.search</code> \(\ll\) <code>p</code> variables,
it would greatly reduce runtimes. Default: <code>important.search = 128</code>.</p></dd>


<dt>warm.start</dt>
<dd><p>Whether to use the last solution as a warm start. Default is <code>warm.start = TRUE</code>.</p></dd>


<dt>nfolds</dt>
<dd><p>The number of folds in cross-validation. Default is <code>nfolds = 5</code>.</p></dd>


<dt>foldid</dt>
<dd><p>an optional integer vector of values between 1, ..., nfolds identifying what fold each observation is in.
The default <code>foldid = NULL</code> would generate a random foldid.</p></dd>


<dt>cov.update</dt>
<dd><p>A logical value only used for <code>family = "gaussian"</code>. If <code>cov.update = TRUE</code>,
use a covariance-based implementation; otherwise, a naive implementation.
The naive method is more computational efficient than covariance-based method when \(p &gt;&gt; n\) and <code>important.search</code> is much large than its default value.
Default: <code>cov.update = FALSE</code>.</p></dd>


<dt>newton</dt>
<dd><p>A character specify the Newton's method for fitting generalized linear models,
it should be either <code>newton = "exact"</code> or <code>newton = "approx"</code>.
If <code>newton = "exact"</code>, then the exact hessian is used,
while <code>newton = "approx"</code> uses diagonal entry of the hessian,
and can be faster (especially when <code>family = "cox"</code>).</p></dd>


<dt>newton.thresh</dt>
<dd><p>a numeric value for controlling positive convergence tolerance.
The Newton's iterations converge when \(|dev - dev_{old}|/(|dev| + 0.1)&lt;\) <code>newton.thresh</code>.</p></dd>


<dt>max.newton.iter</dt>
<dd><p>a integer giving the maximal number of Newton's iteration iterations.
Default is <code>max.newton.iter = 10</code> if <code>newton = "exact"</code>, and <code>max.newton.iter = 60</code> if <code>newton = "approx"</code>.</p></dd>


<dt>early.stop</dt>
<dd><p>A boolean value decide whether early stopping.
If <code>early.stop = TRUE</code>, algorithm will stop if the last tuning value less than the existing one.
Default: <code>early.stop = FALSE</code>.</p></dd>


<dt>ic.scale</dt>
<dd><p>A non-negative value used for multiplying the penalty term
in information criterion. Default: <code>ic.scale = 1</code>.</p></dd>


<dt>num.threads</dt>
<dd><p>An integer decide the number of threads to be
concurrently used for cross-validation (i.e., <code>tune.type = "cv"</code>).
If <code>num.threads = 0</code>, then all of available cores will be used.
Default: <code>num.threads = 0</code>.</p></dd>


<dt>seed</dt>
<dd><p>Seed to be used to divide the sample into cross-validation folds.
Default is <code>seed = 1</code>.</p></dd>


<dt>...</dt>
<dd><p>further arguments to be passed to or from methods.</p></dd>


<dt>formula</dt>
<dd><p>an object of class "<code>formula</code>":
a symbolic description of the model to be fitted.
The details of model specification are given in the "Details" section of "<code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>".</p></dd>


<dt>data</dt>
<dd><p>a data frame containing the variables in the <code>formula</code>.</p></dd>


<dt>subset</dt>
<dd><p>an optional vector specifying a subset of observations to be used.</p></dd>


<dt>na.action</dt>
<dd><p>a function which indicates
what should happen when the data contain <code>NA</code>s.
Defaults to <code>getOption("na.action")</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A S3 <code>abess</code> class object, which is a <code>list</code> with the following components:</p>
<dl><dt>beta</dt>
<dd><p>A \(p\)-by-<code>length(support.size)</code> matrix of coefficients for univariate family, stored in column format;
while a list of <code>length(support.size)</code> coefficients matrix (with size \(p\)-by-<code>ncol(y)</code>) for multivariate family.</p></dd>

<dt>intercept</dt>
<dd><p>An intercept vector of length <code>length(support.size)</code> for univariate family;
while a list of <code>length(support.size)</code> intercept vector (with size <code>ncol(y)</code>) for multivariate family.</p></dd>

<dt>dev</dt>
<dd><p>the deviance of length <code>length(support.size)</code>.</p></dd>

<dt>tune.value</dt>
<dd><p>A value of tuning criterion of length <code>length(support.size)</code>.</p></dd>

<dt>nobs</dt>
<dd><p>The number of sample used for training.</p></dd>

<dt>nvars</dt>
<dd><p>The number of variables used for training.</p></dd>

<dt>family</dt>
<dd><p>Type of the model.</p></dd>

<dt>tune.path</dt>
<dd><p>The path type for tuning parameters.</p></dd>

<dt>support.size</dt>
<dd><p>The actual <code>support.size</code> values used.
Note that it is not necessary the same as the input
if the later have non-integer values or duplicated values.</p></dd>

<dt>edf</dt>
<dd><p>The effective degree of freedom.
It is the same as <code>support.size</code> when <code>lambda = 0</code>.</p></dd>

<dt>best.size</dt>
<dd><p>The best support size selected by the tuning value.</p></dd>

<dt>tune.type</dt>
<dd><p>The criterion type for tuning parameters.</p></dd>

<dt>tune.path</dt>
<dd><p>The strategy for tuning parameters.</p></dd>

<dt>screening.vars</dt>
<dd><p>The character vector specify the feature
selected by feature screening.
It would be an empty character vector if <code>screening.num = 0</code>.</p></dd>

<dt>call</dt>
<dd><p>The original call to <code>abess</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Best-subset selection aims to find a small subset of predictors,
so that the resulting model is expected to have the most desirable prediction accuracy.
Best-subset selection problem under the support size \(s\) is
$$\min_\beta -2 \log L(\beta) \;\;{\rm s.t.}\;\; \|\beta\|_0 \leq s,$$
where \(L(\beta)\) is arbitrary convex functions. In
the GLM case, \(\log L(\beta)\) is the log-likelihood function; in the Cox
model, \(\log L(\beta)\) is the log partial-likelihood function.
The best subset selection problem is solved by the splicing algorithm in this package, see Zhu (2020) for details.
Under mild conditions, the algorithm exactly solve this problem in polynomial time.
This algorithm exploits the idea of sequencing and splicing to reach a stable solution in finite steps when \(s\) is fixed.
The parameters <code>c.max</code>, <code>splicing.type</code> and <code>max.splicing.iter</code> allow user control the splicing technique flexibly.
On the basis of our numerical experiment results, we assign properly parameters to the these parameters as the default
such that the precision and runtime are well balanced, we suggest users keep the default values unchanged.
Please see <a href="https://abess-team.github.io/abess/articles/v10-algorithm.html">this online page</a> for more details about the splicing algorithm.</p>
<p>To find the optimal support size \(s\),
we provide various criterion like GIC, AIC, BIC and cross-validation error to determine it.
More specifically, the sequence of models implied by <code>support.size</code> are fit by the splicing algorithm.
And the solved model with least information criterion or cross-validation error is the optimal model.
The sequential searching for the optimal model is somehow time-wasting.
A faster strategy is golden section (GS), which only need to specify <code>gs.range</code>.
More details about GS is referred to Zhang et al (2021).</p>
<p>It is worthy to note that the parameters <code>newton</code>, <code>max.newton.iter</code> and <code>newton.thresh</code> allows
user control the parameter estimation in non-gaussian models.
The parameter estimation procedure use Newton method or approximated Newton method (only consider the diagonal elements in the Hessian matrix).
Again, we suggest to use the default values unchanged because the same reason for the parameter <code>c.max</code>.</p>
<p><code>abess</code> support some well-known advanced statistical methods to analyze data, including</p><ul><li><p>sure independent screening:  helpful for ultra-high dimensional predictors (i.e., \(p \gg n\)). Use the parameter <code>screening.num</code> to retain the marginally most important predictors. See Fan et al (2008) for more details.</p></li>
<li><p>best subset of group selection:  helpful when predictors have group structure. Use the parameter <code>group.index</code> to specify the group structure of predictors. See Zhang et al (2021) for more details.</p></li>
<li><p>\(l_2\) regularization best subset selection:  helpful when signal-to-ratio is relatively small. Use the parameter <code>lambda</code> to control the magnitude of the regularization term.</p></li>
<li><p>nuisance selection:  helpful when the prior knowledge of important predictors is available. Use the parameter <code>always.include</code> to retain the important predictors.</p></li>
</ul><p>The arbitrary combination of the four methods are definitely support.
Please see <a href="https://abess-team.github.io/abess/articles/v07-advancedFeatures.html">online vignettes</a> for more details about the advanced features support by <code>abess</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>A polynomial algorithm for best-subset selection problem. Junxian Zhu, Canhong Wen, Jin Zhu, Heping Zhang, Xueqin Wang. Proceedings of the National Academy of Sciences Dec 2020, 117 (52) 33117-33123; <a href="https://doi.org/10.1073/pnas.2014241117" class="external-link">doi:10.1073/pnas.2014241117</a></p>
<p>A Splicing Approach to Best Subset of Groups Selection. Zhang, Yanhang, Junxian Zhu, Jin Zhu, and Xueqin Wang (2022). INFORMS Journal on Computing (Accepted). <a href="https://doi.org/10.1287/ijoc.2022.1241" class="external-link">doi:10.1287/ijoc.2022.1241</a></p>
<p>abess: A Fast Best-Subset Selection Library in Python and R. Zhu Jin, Xueqin Wang, Liyuan Hu, Junhao Huang, Kangkang Jiang, Yanhang Zhang, Shiyun Lin, and Junxian Zhu. Journal of Machine Learning Research 23, no. 202 (2022): 1-7.</p>
<p>Sure independence screening for ultrahigh dimensional feature space. Fan, J. and Lv, J. (2008), Journal of the Royal Statistical Society: Series B (Statistical Methodology), 70: 849-911. <a href="https://doi.org/10.1111/j.1467-9868.2008.00674.x" class="external-link">doi:10.1111/j.1467-9868.2008.00674.x</a></p>
<p>Targeted Inference Involving High-Dimensional Data Using Nuisance Penalized Regression. Qiang Sun &amp; Heping Zhang (2020). Journal of the American Statistical Association, <a href="https://doi.org/10.1080/01621459.2020.1737079" class="external-link">doi:10.1080/01621459.2020.1737079</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="print.abess.html">print.abess</a></code>,
<code><a href="predict.abess.html">predict.abess</a></code>,
<code><a href="coef.abess.html">coef.abess</a></code>,
<code><a href="extract.abess.html">extract.abess</a></code>,
<code><a href="plot.abess.html">plot.abess</a></code>,
<code><a href="deviance.abess.html">deviance.abess</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jin Zhu, Junxian Zhu, Canhong Wen, Heping Zhang, Xueqin Wang</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/abess-team/abess" class="external-link">abess</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">support.size</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ linear model ################</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## helpful generic functions:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> abess.default(x = dataset[["x"]], y = dataset[["y"]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    support.size       dev      GIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             0 8902.8419 909.4126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             1 5081.6351 857.9139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             2 2203.6977 778.9392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             3  921.3726 696.3115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             4  833.5074 690.8643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6             5  797.0079 690.9616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7             6  771.9370 692.3404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8             7  759.3075 695.2658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9             8  750.0559 698.6149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10            9  743.0171 702.2471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11           10  736.8746 705.9920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           11  730.2053 709.6578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13           12  726.1450 713.6752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14           13  722.1120 717.6933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15           14  719.8878 721.9598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16           15  718.7611 726.3782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17           16  717.9167 730.8357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18           17  717.2695 735.3205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19           18  716.6929 739.8151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20           19  716.1755 744.3179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21           20  716.1127 748.8842</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">abess_fit</span>, support.size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 x 1 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (intercept) -4.369861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1           .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2           .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x3           .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x4           .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x5           .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x6          83.270800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x7           .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x8           .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x9           .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x10          .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x11          .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x12          .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x13          .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x14         89.689944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x15          .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x16          .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x17          .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x18         43.410846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x19          .       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x20          .       </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">abess_fit</span>,</span></span>
<span class="r-in"><span>  newx <span class="op">=</span> <span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  support.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3           4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  103.05157   91.524774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]   74.66998   85.359664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -289.97309 -299.858907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  -16.35758   -4.241221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  171.80572  162.807112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  126.58540  127.021354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -197.24366 -207.134508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -126.67823 -142.927367</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  -23.29128  -22.898065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -109.76937 -117.273626</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="extract.abess.html">extract</a></span><span class="op">(</span><span class="va">abess_fit</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ beta        :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ i       : int [1:3] 5 13 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ p       : int [1:2] 0 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dim     : int [1:2] 20 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dimnames:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:20] "x1" "x2" "x3" "x4" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr "3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ x       : num [1:3] 83.3 89.7 43.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ factors : list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ intercept   : num -4.37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.size: num 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.vars: chr [1:3] "x6" "x14" "x18"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.beta: num [1:3] 83.3 89.7 43.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dev         : num 921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tune.value  : num 696</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 8902.8419 5081.6351 2203.6977  921.3726  833.5074  797.0079  771.9370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8]  759.3075  750.0559  743.0171  736.8746  730.2053  726.1450  722.1120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15]  719.8878  718.7611  717.9167  717.2695  716.6929  716.1755  716.1127</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="abess-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span>, type <span class="op">=</span> <span class="st">"tune"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="abess-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ logistic model ################</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## allow cross-validation to tuning</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"binomial"</span>, tune.type <span class="op">=</span> <span class="st">"cv"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> abess.default(x = dataset[["x"]], y = dataset[["y"]], family = "binomial", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     tune.type = "cv")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    support.size        dev        cv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             0 68.5929800 13.888785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             1 46.6936375  9.467560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             2 22.3141723  4.795585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             3 17.6033381  5.453335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             4 16.8661842  9.347666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6             5 16.1567523 14.520950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7             6 15.1597900 22.506390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8             7 14.1855894 37.171158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9             8 12.9185012 47.062152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10            9 11.0144647 54.975814</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11           10 12.0662413 60.199527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           11 10.4759853 70.803152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13           12  9.2660175 80.517063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14           13  3.8066489 86.359262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15           14  3.6176817 89.695262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16           15  0.8178666 91.826185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17           16  0.6077557 93.099175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18           17  0.5993617 93.466494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19           18  0.2749951 93.663214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20           19  0.1004884 93.783418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21           20  1.8082868 94.035446</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ poisson model ################</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span>, family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"poisson"</span>, tune.type <span class="op">=</span> <span class="st">"cv"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> abess.default(x = dataset[["x"]], y = dataset[["y"]], family = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     tune.type = "cv")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    support.size        dev        cv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             0   44.95340  10.19365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             1  -31.62397   3.28437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             2 -100.57515 -10.57293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             3 -157.18472 -30.45472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             4 -160.75596 -31.01768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6             5 -163.01916 -30.63952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7             6 -164.82977 -30.14524</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8             7 -166.39686 -26.74170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9             8 -167.33059 -27.33824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10            9 -168.30048 -27.42207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11           10 -168.98526 -27.25689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           11 -169.76250 -26.64814</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13           12 -170.25995 -27.38532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14           13 -171.31745 -28.11082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15           14 -171.54370 -28.38133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16           15 -171.74975 -28.63384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17           16 -171.85325 -28.08692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18           17 -171.91807 -27.93900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19           18 -171.94049 -28.14633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20           19 -171.95597 -27.96296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21           20 -171.95939 -27.89870</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ Cox model ################</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span>, family <span class="op">=</span> <span class="st">"cox"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"cox"</span>, tune.type <span class="op">=</span> <span class="st">"cv"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ Multivariate gaussian model ################</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span>, family <span class="op">=</span> <span class="st">"mgaussian"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"mgaussian"</span>, tune.type <span class="op">=</span> <span class="st">"cv"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span>, type <span class="op">=</span> <span class="st">"l2norm"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="abess-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ Multinomial model (multi-classification) ################</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span>, family <span class="op">=</span> <span class="st">"multinomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"multinomial"</span>, tune.type <span class="op">=</span> <span class="st">"cv"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">abess_fit</span>,</span></span>
<span class="r-in"><span>  newx <span class="op">=</span> <span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  support.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"response"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  1            2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 3.195016e-01 6.796457e-01 8.526170e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 9.926804e-01 2.440772e-07 7.319345e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 1.994464e-08 1.143640e-05 9.999885e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 1.922589e-09 1.000000e+00 1.508267e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 9.983970e-01 1.644070e-08 1.602938e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 4.380697e-01 4.031366e-01 1.587937e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 1.752322e-05 6.737499e-01 3.262325e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 1.397247e-06 9.834317e-01 1.656692e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 2.634463e-04 1.642882e-01 8.354483e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 5.926381e-03 2.231758e-07 9.940734e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`4`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  1            2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 1.483046e-01 8.516877e-01 7.775864e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 9.997506e-01 1.127507e-06 2.483045e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 5.751059e-11 3.022517e-09 1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 3.633755e-11 1.000000e+00 7.527286e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 9.911478e-01 5.630004e-10 8.852224e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 5.815429e-01 1.173098e-01 3.011473e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 3.581717e-06 2.443244e-02 9.755640e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 9.683075e-07 9.846617e-01 1.533729e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 2.219998e-04 7.084179e-01 2.913601e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 2.934310e-03 1.071389e-07 9.970656e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ Ordinal regression  ################</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span>, family <span class="op">=</span> <span class="st">"ordinal"</span>, class.num <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"ordinal"</span>, tune.type <span class="op">=</span> <span class="st">"cv"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">abess_fit</span>, support.size <span class="op">=</span> <span class="va">abess_fit</span><span class="op">[[</span><span class="st">"best.size"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">abess_fit</span>,</span></span>
<span class="r-in"><span>  newx <span class="op">=</span> <span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  support.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"response"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  1            2            3             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 4.262225e-05 1.829633e-02 9.726829e-01 8.978109e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 7.882173e-01 2.111701e-01 6.125573e-04 1.037531e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 1.486210e-05 6.456936e-03 9.682043e-01 2.532388e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 1.577722e-10 6.899165e-08 4.083410e-04 9.995916e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 9.999979e-01 2.067605e-06 4.727471e-09 8.002488e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 9.966919e-01 3.300482e-03 7.571409e-06 1.281646e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 8.368720e-10 3.659527e-07 2.162164e-03 9.978375e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 4.271390e-07 1.867472e-04 5.250122e-01 4.748006e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 8.728258e-01 1.268418e-01 3.322732e-04 5.626364e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 2.426574e-02 8.916995e-01 8.401922e-02 1.552701e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`4`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  1            2            3             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 2.718879e-07 1.668930e-03 9.974270e-01 9.038274e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 9.222029e-01 7.778339e-02 1.371784e-05 2.074940e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 2.028760e-07 1.245842e-03 9.975430e-01 1.210908e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 4.080690e-15 2.509040e-11 1.659043e-05 9.999834e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 1.000000e+00 2.518530e-09 4.096723e-13 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 9.985539e-01 1.445840e-03 2.354909e-07 3.561595e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 1.450164e-14 8.916432e-11 5.895529e-05 9.999410e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 8.009007e-10 4.924368e-06 7.650435e-01 2.349516e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 8.676204e-01 1.323548e-01 2.481049e-05 3.752842e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 4.631050e-03 9.615982e-01 3.377066e-02 5.286555e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">########## Best group subset selection #############</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>, group.index <span class="op">=</span> <span class="va">group_index</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="extract.abess.html">extract</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ beta        :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ i       : int [1:8] 4 5 12 13 14 15 16 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ p       : int [1:2] 0 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dim     : int [1:2] 20 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dimnames:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:20] "x1" "x2" "x3" "x4" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr "4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ x       : num [1:8] 1.992 82.397 -0.735 88.545 -4.368 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ factors : list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ intercept   : num -4.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.size: int 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.vars: chr [1:8] "x5" "x6" "x13" "x14" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.beta: num [1:8] 1.992 82.397 -0.735 88.545 -4.368 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dev         : num 819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tune.value  : num 699</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ Golden section searching ################</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>, tune.path <span class="op">=</span> <span class="st">"gsection"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> abess.default(x = dataset[["x"]], y = dataset[["y"]], tune.path = "gsection")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   support.size      dev      GIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            3 921.3726 696.3115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            4 833.5074 690.8643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            5 797.0079 690.9616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            6 771.9370 692.3404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            8 750.0559 698.6149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           13 722.1120 717.6933</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ Feature screening ################</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  screening.num <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="extract.abess.html">extract</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ beta        :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ i       : int [1:3] 288 642 780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ p       : int [1:2] 0 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dim     : int [1:2] 1000 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dimnames:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:1000] "x1" "x2" "x3" "x4" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr "3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ x       : num [1:3] 145.3 51.9 160.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ factors : list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ intercept   : num 5.53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.size: int 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.vars: chr [1:3] "x289" "x643" "x781"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.beta: num [1:3] 145.3 51.9 160.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dev         : num 1821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tune.value  : num 772</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################ Sparse predictor ################</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org/" class="external-link">Matrix</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Matrix</span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html" class="external-link">Matrix</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="extract.abess.html">extract</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ beta        :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ i       : int [1:2] 288 780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ p       : int [1:2] 0 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dim     : int [1:2] 1000 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dimnames:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:1000] "x1" "x2" "x3" "x4" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr "2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ x       : num [1:2] 147 171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ factors : list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ intercept   : num -10.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.size: int 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.vars: chr [1:2] "x289" "x781"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ support.beta: num [1:2] 147 171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dev         : num 7266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tune.value  : num 910</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">################  Formula interface  ################</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"trim32"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu">abess</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">trim32</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abess_fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> abess.formula(formula = y ~ ., data = trim32)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    support.size         dev       GIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             0 0.010369311 -548.2686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             1 0.004088476 -650.2178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             2 0.002961921 -679.1658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             3 0.002560296 -686.9195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             4 0.002392097 -685.3417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6             5 0.002392089 -675.6100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7             6 0.002300641 -670.5554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8             7 0.002295887 -661.0715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9             8 0.002275372 -652.4165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10            9 0.002275332 -642.6865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11           10 0.002256348 -633.9598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           11 0.002243761 -624.8989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13           12 0.002225414 -616.1521</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jin Zhu, Zezhi Wang, Liyuan Hu, Junhao Huang, Kangkang Jiang, Yanhang Zhang, Borui Tang, Shiyun Lin, Junxian Zhu, Canhong Wen, Heping Zhang, Xueqin Wang.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'd32715b0e35635336aba6377dd751e21',
    indexName: 'abess',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

