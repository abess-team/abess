<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-Response Linear Regression • abess</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Multi-Response Linear Regression">
<meta property="og:description" content="abess">
<meta property="og:image" content="https://abess-team.github.io/abess/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">abess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v01-abess-guide.html">Quick start for `abess`: Linear regression</a>
    </li>
    <li>
      <a href="../articles/v03-classification.html">Classification: Logistic Regression and Multinomial Extension</a>
    </li>
    <li>
      <a href="../articles/v04-PoissonGammaReg.html">Positive response: Poisson and Gamma regression</a>
    </li>
    <li>
      <a href="../articles/v05-coxreg.html">Best Subset Selection for Censored Response</a>
    </li>
    <li>
      <a href="../articles/v06-MultiTaskLearning.html">Multi-Response Linear Regression</a>
    </li>
    <li>
      <a href="../articles/v07-advancedFeatures.html">Advanced Features</a>
    </li>
    <li>
      <a href="../articles/v08-sPCA.html">Principal component analysis</a>
    </li>
    <li>
      <a href="../articles/v09-fasterSetting.html">Tips for faster computation</a>
    </li>
    <li>
      <a href="../articles/v10-algorithm.html">ABESS algorithm: details</a>
    </li>
    <li>
      <a href="../articles/v11-power-of-abess.html">Power of abess</a>
    </li>
    <li>
      <a href="../articles/v12-Robust-Principal-Component-Analysis.html">Robust Principal Component Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/abess-team/abess/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v06-MultiTaskLearning_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multi-Response Linear Regression</h1>
                        <h4 data-toc-skip class="author">Jin Zhu, Liyuan Hu</h4>
            
            <h4 data-toc-skip class="date">2021/5/31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/abess-team/abess/tree/master/R-package/../vignettes/v06-MultiTaskLearning.Rmd" class="external-link"><code>../vignettes/v06-MultiTaskLearning.Rmd</code></a></small>
      <div class="hidden name"><code>v06-MultiTaskLearning.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="brief-introduction">Brief Introduction<a class="anchor" aria-label="anchor" href="#brief-introduction"></a>
</h2>
<p>Multivariate multi-response linear regression (a.k.a., multi-task learning) aims at predicting multiple responses at the same time, and thus, it is a natural extension for classical linear regression where the response is univariate. Multivariate multi-response linear regression (MMLR) is very helpful for the analysis of correlated response such as chemical measurements for soil samples and microRNAs associated with Glioblastoma multiforme cancer. Let <span class="math inline">\(y\)</span> is <span class="math inline">\(m\)</span>-dimensional response variable, <span class="math inline">\(x\)</span> is <span class="math inline">\(p\)</span>-dimensional predictors, <span class="math inline">\(B \in R^{m \times p}\)</span> is coefficient matrix, the MMLR model for the multivariate response is given by <span class="math display">\[y = B x + \varepsilon,\]</span> where <span class="math inline">\(\varepsilon\)</span> is <span class="math inline">\(m\)</span>-dimensional random noise variable with zero mean.</p>
<p>Due to the Occam’s razor principal or the high-dimensionality of predictors, it is meaningful to use a small amount of predictors to conduct multi-task learning. For example, understanding the relationship between gene expression and symptoms of a disease have significant importance in identifying potential makers. Many diseases usually involve multiple manifestations and those manifestations are usually related. In some cases, it makes sense to predict those manifestations using a small but the same set of predictors. The best subset selection problem under the MMLR model is formulated as <span class="math display">\[\frac{1}{2n} \| Y - XB \|_{2}^2, \text{ s.t. } \| B \|_{0, 2} \leq s,\]</span> where, <span class="math inline">\(Y \in R^{n \times m}\)</span> and <span class="math inline">\(X \in R^{n \times p}\)</span> record <span class="math inline">\(n\)</span> observations’ response and predictors, respectively. Here <span class="math inline">\(\| B \|_{0, 2} = \sum_{i = 1}^{p} I(B_{i\cdot} = {\bf 0})\)</span>, where <span class="math inline">\(B_{i\cdot}\)</span> is the <span class="math inline">\(i\)</span>-th row of coefficient matrix <span class="math inline">\(B\)</span> and <span class="math inline">\({\bf 0} \in R^{m}\)</span> is an all zero vector.</p>
</div>
<div class="section level2">
<h2 id="quick-example">Quick example<a class="anchor" aria-label="anchor" href="#quick-example"></a>
</h2>
<p>We use an artificial dataset to demonstrate how to solve best subset selection problem for MMLR with <strong>abess</strong> package. The <code><a href="../reference/generate.data.html">generate.data()</a></code> function provides a simple way to generate suitable for this task. The synthetic data have 100 observations with 3-dimensional responses and 20-dimensional predictors. Note that there are three predictors have an impact on the responses. <!-- The assumption behind is the response vector following a multivariate gaussian distribution whose mean vector is linear to `x`. --></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/abess-team/abess" class="external-link">abess</a></span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">support.size</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.data.html">generate.data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">support.size</span>, family <span class="op">=</span> <span class="st">"mgaussian"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                y1          y2         y3</span></span>
<span><span class="co">## [1,]  104.3057832  113.312533   74.75589</span></span>
<span><span class="co">## [2,]   58.6265922   -7.224093   40.39639</span></span>
<span><span class="co">## [3,] -294.1884567 -288.633432 -227.19660</span></span>
<span><span class="co">## [4,]   -0.5421699   85.740440  -12.95485</span></span>
<span><span class="co">## [5,]  160.4051274   92.082972  138.51176</span></span>
<span><span class="co">## [6,]  132.9713249  132.500001  119.50803</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span><span class="op">[[</span><span class="st">"beta"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]     [,2]     [,3]</span></span>
<span><span class="co">##  [1,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">##  [2,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">##  [3,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">##  [4,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">##  [5,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">##  [6,] 84.67713 92.93448 75.47809</span></span>
<span><span class="co">##  [7,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">##  [8,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">##  [9,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">## [10,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">## [11,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">## [12,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">## [13,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">## [14,] 85.82187 34.34362 64.39117</span></span>
<span><span class="co">## [15,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">## [16,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">## [17,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">## [18,] 47.40922 59.10738 31.21572</span></span>
<span><span class="co">## [19,]  0.00000  0.00000  0.00000</span></span>
<span><span class="co">## [20,]  0.00000  0.00000  0.00000</span></span></code></pre>
<p>To carry out sparse multi-task learning, you can call the <code><a href="../reference/abess.html">abess()</a></code> function with <code>family</code> specified to <code>mguassian</code>. Here is an example.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abess.html">abess</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span>, <span class="va">dataset</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                   family <span class="op">=</span> <span class="st">"mgaussian"</span>, tune.type <span class="op">=</span> <span class="st">"cv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract.abess.html">extract</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $beta</span></span>
<span><span class="co">## 20 x 3 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##           y1       y2       y3</span></span>
<span><span class="co">## x1   .        .        .      </span></span>
<span><span class="co">## x2   .        .        .      </span></span>
<span><span class="co">## x3   .        .        .      </span></span>
<span><span class="co">## x4   .        .        .      </span></span>
<span><span class="co">## x5   .        .        .      </span></span>
<span><span class="co">## x6  84.62951 92.75669 75.32181</span></span>
<span><span class="co">## x7   .        .        .      </span></span>
<span><span class="co">## x8   .        .        .      </span></span>
<span><span class="co">## x9   .        .        .      </span></span>
<span><span class="co">## x10  .        .        .      </span></span>
<span><span class="co">## x11  .        .        .      </span></span>
<span><span class="co">## x12  .        .        .      </span></span>
<span><span class="co">## x13  .        .        .      </span></span>
<span><span class="co">## x14 85.34962 34.83632 64.82193</span></span>
<span><span class="co">## x15  .        .        .      </span></span>
<span><span class="co">## x16  .        .        .      </span></span>
<span><span class="co">## x17  .        .        .      </span></span>
<span><span class="co">## x18 47.37992 59.28869 31.23534</span></span>
<span><span class="co">## x19  .        .        .      </span></span>
<span><span class="co">## x20  .        .        .      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $intercept</span></span>
<span><span class="co">##          y1          y2          y3 </span></span>
<span><span class="co">## -0.75263061  0.12788731 -0.07370499 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $support.size</span></span>
<span><span class="co">## [1] 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $support.vars</span></span>
<span><span class="co">## [1] "x6"  "x14" "x18"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $support.beta</span></span>
<span><span class="co">##           y1       y2       y3</span></span>
<span><span class="co">## x6  84.62951 92.75669 75.32181</span></span>
<span><span class="co">## x14 85.34962 34.83632 64.82193</span></span>
<span><span class="co">## x18 47.37992 59.28869 31.23534</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $dev</span></span>
<span><span class="co">## [1] 112.0141</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $tune.value</span></span>
<span><span class="co">## [1] 117.1686</span></span></code></pre>
<p>The output of <code>extract(abess_fit)</code> shows that the support set is correctly identified and the parameter estimation approach to the truth.</p>
<p>Since there are three responses, we will obtain three solution path plots when calling the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function. The three plots corresponds to <span class="math inline">\(y_1, y_2, y_3\)</span>, respectively.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="v06-MultiTaskLearning_files/figure-html/unnamed-chunk-3-1.png" width="700"><img src="v06-MultiTaskLearning_files/figure-html/unnamed-chunk-3-2.png" width="700"><img src="v06-MultiTaskLearning_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jin Zhu, Liyuan Hu, Junhao Huang, Kangkang Jiang, Yanhang Zhang, Zezhi Wang, Borui Tang, Shiyun Lin, Junxian Zhu, Canhong Wen, Heping Zhang, Xueqin Wang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'd32715b0e35635336aba6377dd751e21',
    indexName: 'abess',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
