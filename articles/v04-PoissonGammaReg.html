<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Positive response: Poisson and Gamma regression â€¢ abess</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Positive response: Poisson and Gamma regression">
<meta property="og:description" content="abess">
<meta property="og:image" content="https://abess-team.github.io/abess/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">abess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v01-abess-guide.html">Quick start for `abess`: Linear regression</a>
    </li>
    <li>
      <a href="../articles/v03-classification.html">Classification: Logistic Regression and Multinomial Extension</a>
    </li>
    <li>
      <a href="../articles/v04-PoissonGammaReg.html">Positive response: Poisson and Gamma regression</a>
    </li>
    <li>
      <a href="../articles/v05-coxreg.html">Best Subset Selection for Censored Response</a>
    </li>
    <li>
      <a href="../articles/v06-MultiTaskLearning.html">Multi-Response Linear Regression</a>
    </li>
    <li>
      <a href="../articles/v07-advancedFeatures.html">Advanced Features</a>
    </li>
    <li>
      <a href="../articles/v08-sPCA.html">Principal component analysis</a>
    </li>
    <li>
      <a href="../articles/v09-fasterSetting.html">Tips for faster computation</a>
    </li>
    <li>
      <a href="../articles/v10-algorithm.html">ABESS algorithm: details</a>
    </li>
    <li>
      <a href="../articles/v11-power-of-abess.html">Power of abess</a>
    </li>
    <li>
      <a href="../articles/v12-Robust-Principal-Component-Analysis.html">Robust Principal Component Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/abess-team/abess/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Positive response: Poisson and Gamma
regression</h1>
                        <h4 data-toc-skip class="author">Liyuan Hu, Jin
Zhu, Borui Tang</h4>
            
            <h4 data-toc-skip class="date">2021/11/3</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/abess-team/abess/tree/master/R-package/../vignettes/v04-PoissonGammaReg.Rmd" class="external-link"><code>../vignettes/v04-PoissonGammaReg.Rmd</code></a></small>
      <div class="hidden name"><code>v04-PoissonGammaReg.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="poisson-regression">Poisson Regression<a class="anchor" aria-label="anchor" href="#poisson-regression"></a>
</h2>
<p>Poisson regression involves regression models in which the response
variable is in the form of counts. For example, the count of number of
car accidents or number of customers in line at a reception desk. The
response variable is assumed to be generated from Poisson
distribution.</p>
<p>The Poisson regression is defined as <span class="math display">\[
\log(E(y_i|x_i)) = x_i^T \beta.
\]</span> We generate some artificial data using the following logic.
Consider a dataset containing the information of complain calls about
100 companies over a period of 10 years. <code>count</code> gives the
number of complains, and the dataset also have other variables like
<code>age</code>, <code>sex</code>, <code>job</code>,
<code>education</code>, <code>region</code>, <code>marriage</code>. The
<code><a href="../reference/generate.data.html">generate.data()</a></code> function allow you to generate simulated
data. By specifying <code>support.size = 3</code>, here we set only 3 of
the 5 above mentioned variable have effect on the expectation of the
response <code>count</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/abess-team/abess" class="external-link">abess</a></span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.data.html">generate.data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fl">6</span>, support.size <span class="op">=</span> <span class="fl">3</span>,family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"job"</span>, </span>
<span>                     <span class="st">"education"</span>, <span class="st">"region"</span>, <span class="st">"marriage"</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">beta</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0000000 0.0000000 1.3161226 0.7623454 0.6557793 0.0000000</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             age         sex        job  education     region    marriage</span></span>
<span><span class="co">## [1,] -0.6264538 -0.62036668  0.4094018  0.8936737  1.0744410  0.07730312</span></span>
<span><span class="co">## [2,]  0.1836433  0.04211587  1.6888733 -1.0472981  1.8956548 -0.29686864</span></span>
<span><span class="co">## [3,] -0.8356286 -0.91092165  1.5865884  1.9713374 -0.6029973 -1.18324224</span></span>
<span><span class="co">## [4,]  1.5952808  0.15802877 -0.3309078 -0.3836321 -0.3908678  0.01129269</span></span>
<span><span class="co">## [5,]  0.3295078 -0.65458464 -2.2852355  1.6541453 -0.4162220  0.99160104</span></span>
<span><span class="co">## [6,] -0.8204684  1.76728727  2.4976616  1.5122127 -0.3756574  1.59396745</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'count'</span> <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">y</span>, <span class="va">dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="best-subset-selection-for-poisson-regression">Best Subset Selection for Poisson Regression<a class="anchor" aria-label="anchor" href="#best-subset-selection-for-poisson-regression"></a>
</h2>
<p>The <code><a href="../reference/abess.html">abess()</a></code> function in the <code>abess</code> package
allows you to perform best subset selection in a highly efficient way.
You can call the <code><a href="../reference/abess.html">abess()</a></code> function using formula just like
what you do with <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>. Or you can specify the design matrix
<code>x</code> and the response <code>y</code>. To carry out a poisson
regression, we should set the <code>family = "poisson"</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/abess-team/abess" class="external-link">abess</a></span><span class="op">)</span></span>
<span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abess.html">abess</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">y</span>, family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abess.html">abess</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">complain</span>, family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "abess"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="interpret-the-result">Interpret the Result<a class="anchor" aria-label="anchor" href="#interpret-the-result"></a>
</h2>
<p>Hold on, we arenâ€™t finished yet. After get the estimator, we can
further do more exploring work. The output of <code><a href="../reference/abess.html">abess()</a></code>
function contains the best model for all the candidate support size in
the <code>support.size</code>. You can use some generic function to
quickly draw some information of those estimators.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw the estimated coefficients on all candidate support size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 7 x 7 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##                    0         1         2          3          4           5</span></span>
<span><span class="co">## (intercept) 1.581038 0.4281173 0.2558213 -0.1046718 -0.1048012 -0.11247259</span></span>
<span><span class="co">## age         .        .         .          .         -0.1220305 -0.14952569</span></span>
<span><span class="co">## sex         .        .         .          .          .         -0.05079627</span></span>
<span><span class="co">## job         .        1.5000590 1.3764398  1.3352362  1.3066528  1.31052729</span></span>
<span><span class="co">## education   .        .         .          0.7481282  0.7402961  0.74962052</span></span>
<span><span class="co">## region      .        .         0.5200980  0.6772810  0.7321931  0.73122143</span></span>
<span><span class="co">## marriage    .        .         .          .          .          .         </span></span>
<span><span class="co">##                        6</span></span>
<span><span class="co">## (intercept) -0.113009283</span></span>
<span><span class="co">## age         -0.150101543</span></span>
<span><span class="co">## sex         -0.053034139</span></span>
<span><span class="co">## job          1.310882786</span></span>
<span><span class="co">## education    0.749947673</span></span>
<span><span class="co">## region       0.733199019</span></span>
<span><span class="co">## marriage     0.004493453</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the deviance of the estimated model on all candidate support size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  -282.3847  -792.8596  -936.6450 -1011.8841 -1013.1902 -1013.6433 -1013.6466</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the fitted model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Call:</span></span>
<span><span class="co">## abess.formula(formula = count ~ ., data = complain, family = "poisson")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   support.size        dev        GIC</span></span>
<span><span class="co">## 1            0  -282.3847  -564.7694</span></span>
<span><span class="co">## 2            1  -792.8596 -1582.9829</span></span>
<span><span class="co">## 3            2  -936.6450 -1867.8174</span></span>
<span><span class="co">## 4            3 -1011.8841 -2015.5593</span></span>
<span><span class="co">## 5            4 -1013.1902 -2015.4350</span></span>
<span><span class="co">## 6            5 -1013.6433 -2013.6050</span></span>
<span><span class="co">## 7            6 -1013.6466 -2010.8751</span></span></code></pre>
<p>Prediction is allowed for all the estimated models. Just call
<code><a href="../reference/predict.abess.html">predict.abess()</a></code> function with the <code>support.size</code>
set to the size of model you are interested in. If a
<code>support.size</code> is not provided, prediction will be made on
the model with best tuning value.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">abess_fit</span>, newx <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">x</span>, support.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              3         4</span></span>
<span><span class="co">## [1,]  1.838257  1.954873</span></span>
<span><span class="co">## [2,]  2.650751  2.692234</span></span>
<span><span class="co">## [3,]  3.080213  3.088154</span></span>
<span><span class="co">## [4,] -1.098245 -1.302048</span></span>
<span><span class="co">## [5,] -2.200387 -2.211218</span></span>
<span><span class="co">## [6,]  4.107200  4.103329</span></span></code></pre>
<p>The <code><a href="../reference/plot.abess.html">plot.abess()</a></code> function helps to visualize the change
of models with the change of support size. There are 5 types of graph
you can generate, including <code>coef</code> for the coefficient value,
<code>l2norm</code> for the L2-norm of the coefficients,
<code>dev</code> for the deviance and <code>tune</code> for the tuning
value. Default if <code>coef</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="v04-PoissonGammaReg_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The graph shows that, beginning from the most dense model, the 3rd
variable (job) is included in the active set until the support size
reaches 0.</p>
<p>We can also generate a graph about the tuning value. Remember that we
use the default GIC to tune the support size.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span>, type <span class="op">=</span> <span class="st">"tune"</span><span class="op">)</span></span></code></pre></div>
<p><img src="v04-PoissonGammaReg_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The tuning value reaches the lowest point at 3. And We might choose
the estimated model with support size equals 6 as our final model. In
fact, the tuning values of different model sizes are provided in
<code>tune.value</code> of the <code>abess</code> object. You can get
the best model size through the following call.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">abess_fit</span><span class="op">$</span><span class="va">support.size</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">$</span><span class="va">tune.value</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<p>To extract the specified model from the <code>abess</code> object, we
can call the <code><a href="../reference/extract.abess.html">extract()</a></code> function with a given
<code>support.size</code>. If <code>support.size</code> is not provided,
the model with the best tuning value will be returned. Here we extract
the model with support size equals to 3.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best.model</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract.abess.html">extract</a></span><span class="op">(</span><span class="va">abess_fit</span>, support.size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">best.model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 7</span></span>
<span><span class="co">##  $ beta        :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span></span>
<span><span class="co">##   .. ..@ i       : int [1:3] 2 3 4</span></span>
<span><span class="co">##   .. ..@ p       : int [1:2] 0 3</span></span>
<span><span class="co">##   .. ..@ Dim     : int [1:2] 6 1</span></span>
<span><span class="co">##   .. ..@ Dimnames:List of 2</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:6] "age" "sex" "job" "education" ...</span></span>
<span><span class="co">##   .. .. ..$ : chr "3"</span></span>
<span><span class="co">##   .. ..@ x       : num [1:3] 1.335 0.748 0.677</span></span>
<span><span class="co">##   .. ..@ factors : list()</span></span>
<span><span class="co">##  $ intercept   : num -0.105</span></span>
<span><span class="co">##  $ support.size: num 3</span></span>
<span><span class="co">##  $ support.vars: chr [1:3] "job" "education" "region"</span></span>
<span><span class="co">##  $ support.beta: num [1:3] 1.335 0.748 0.677</span></span>
<span><span class="co">##  $ dev         : num -1012</span></span>
<span><span class="co">##  $ tune.value  : num -2016</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best.model</span><span class="op">$</span><span class="va">beta</span></span></code></pre></div>
<pre><code><span><span class="co">## 6 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##                   3</span></span>
<span><span class="co">## age       .        </span></span>
<span><span class="co">## sex       .        </span></span>
<span><span class="co">## job       1.3352362</span></span>
<span><span class="co">## education 0.7481282</span></span>
<span><span class="co">## region    0.6772810</span></span>
<span><span class="co">## marriage  .</span></span></code></pre>
<p>The return is a list containing the basic information of the
estimated model. The best model has estimated coefficients every close
to the true coefficients and it successfully recovers the correct
support.</p>
</div>
<div class="section level2">
<h2 id="gamma-regression">Gamma Regression<a class="anchor" aria-label="anchor" href="#gamma-regression"></a>
</h2>
<p>Gamma regression can be used when you meet a positive continuous
response variable such as payments for insurance claims, or the lifetime
of a redundant system. It is well known that the density of Gamma
distribution can be represented as a function of a mean parameter (<span class="math inline">\(\mu\)</span>) and a shape parameter (<span class="math inline">\(\alpha\)</span>), specifically, <span class="math display">\[
f(y \mid \mu, \alpha)=\frac{1}{y \Gamma(\alpha)}\left(\frac{\alpha
y}{\mu}\right)^{\alpha} e^{-\alpha y / \mu} {I}_{(0, \infty)}(y),
\]</span> where <span class="math inline">\(I(\cdot)\)</span> denotes
the indicator function. In the Gamma regression model, response variable
IS assumed to follow Gamma distribution. Specifically, <span class="math display">\[
y_i \sim Gamma(\mu_i, \alpha),
\]</span> where <span class="math inline">\(1/\mu_i =
x_i^T\beta\)</span>.</p>
<p>We apply the above procedure for gamma regression simply by changing
<code>family = "poisson"</code> to <code>family = "gamma"</code>. This
time we consider the response variables as (continuous) levels of
satisfaction. Also, instead of GIC, we carry out cross validation to
tune the support size by setting <code>tune.type = "cv"</code> in
<code>abess</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate data</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.data.html">generate.data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fl">6</span>, support.size <span class="op">=</span> <span class="fl">3</span>, family <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"job"</span>, </span>
<span>                     <span class="st">"education"</span>, <span class="st">"region"</span>, <span class="st">"marriage"</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">beta</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  0.00000  0.00000 80.37275 66.66677 64.02925  0.00000</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             age         sex        job  education     region    marriage</span></span>
<span><span class="co">## [1,] -0.6264538 -0.62036668  0.4094018  0.8936737  1.0744410  0.07730312</span></span>
<span><span class="co">## [2,]  0.1836433  0.04211587  1.6888733 -1.0472981  1.8956548 -0.29686864</span></span>
<span><span class="co">## [3,] -0.8356286 -0.91092165  1.5865884  1.9713374 -0.6029973 -1.18324224</span></span>
<span><span class="co">## [4,]  1.5952808  0.15802877 -0.3309078 -0.3836321 -0.3908678  0.01129269</span></span>
<span><span class="co">## [5,]  0.3295078 -0.65458464 -2.2852355  1.6541453 -0.4162220  0.99160104</span></span>
<span><span class="co">## [6,] -0.8204684  1.76728727  2.4976616  1.5122127 -0.3756574  1.59396745</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'count'</span><span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">y</span>, <span class="va">dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abess.html">abess</a></span><span class="op">(</span><span class="va">count</span><span class="op">~</span><span class="va">.</span>, <span class="va">complain</span>, family <span class="op">=</span> <span class="st">"gamma"</span>, tune.type <span class="op">=</span><span class="st">"cv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># draw the estimated coefficients on all candidate support size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 7 x 7 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##                     0         1          2          3           4           5</span></span>
<span><span class="co">## (intercept) -277.2181 -444.2162 -452.68358 -455.14238 -455.695434 -456.352800</span></span>
<span><span class="co">## age            .         .         .          .          5.492983    6.932135</span></span>
<span><span class="co">## sex            .         .         .          .          .         -11.246921</span></span>
<span><span class="co">## job            .         .       -95.09195  -82.23064  -83.524466  -83.130301</span></span>
<span><span class="co">## education      .         .         .        -65.20971  -65.602162  -65.574434</span></span>
<span><span class="co">## region         .      -144.2534  -84.56022  -63.44148  -63.867156  -61.900510</span></span>
<span><span class="co">## marriage       .         .         .          .          .           .       </span></span>
<span><span class="co">##                       6</span></span>
<span><span class="co">## (intercept) -456.411167</span></span>
<span><span class="co">## age            6.758009</span></span>
<span><span class="co">## sex          -11.446048</span></span>
<span><span class="co">## job          -82.970295</span></span>
<span><span class="co">## education    -65.530386</span></span>
<span><span class="co">## region       -61.918597</span></span>
<span><span class="co">## marriage      -1.833652</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the deviance of the estimated model on all candidate support size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -462.4805 -498.1930 -503.9212 -505.4016 -505.4117 -505.4434 -505.4443</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the fitted model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Call:</span></span>
<span><span class="co">## abess.formula(formula = count ~ ., data = complain, family = "gamma", </span></span>
<span><span class="co">##     tune.type = "cv")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   support.size       dev         cv</span></span>
<span><span class="co">## 1            0 -462.4805  -88.64702</span></span>
<span><span class="co">## 2            1 -498.1930  -94.02901</span></span>
<span><span class="co">## 3            2 -503.9212  -99.44424</span></span>
<span><span class="co">## 4            3 -505.4016 -100.94369</span></span>
<span><span class="co">## 5            4 -505.4117 -100.99783</span></span>
<span><span class="co">## 6            5 -505.4434 -101.00148</span></span>
<span><span class="co">## 7            6 -505.4443 -101.00700</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># predict results for given support sizes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">abess_fit</span>, newx <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">x</span>, support.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              3         4</span></span>
<span><span class="co">## [1,] -615.2481 -620.5800</span></span>
<span><span class="co">## [2,] -645.9886 -648.1140</span></span>
<span><span class="co">## [3,] -675.9039 -683.6168</span></span>
<span><span class="co">## [4,] -378.1178 -369.1630</span></span>
<span><span class="co">## [5,] -348.6866 -344.9450</span></span>
<span><span class="co">## [6,] -735.3054 -744.0304</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="v04-PoissonGammaReg_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tuning plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span>, type <span class="op">=</span> <span class="st">"tune"</span><span class="op">)</span></span></code></pre></div>
<p><img src="v04-PoissonGammaReg_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract fitted model</span></span>
<span><span class="va">best.model</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract.abess.html">extract</a></span><span class="op">(</span><span class="va">abess_fit</span>, support.size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">best.model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 7</span></span>
<span><span class="co">##  $ beta        :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span></span>
<span><span class="co">##   .. ..@ i       : int [1:3] 2 3 4</span></span>
<span><span class="co">##   .. ..@ p       : int [1:2] 0 3</span></span>
<span><span class="co">##   .. ..@ Dim     : int [1:2] 6 1</span></span>
<span><span class="co">##   .. ..@ Dimnames:List of 2</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:6] "age" "sex" "job" "education" ...</span></span>
<span><span class="co">##   .. .. ..$ : chr "3"</span></span>
<span><span class="co">##   .. ..@ x       : num [1:3] -82.2 -65.2 -63.4</span></span>
<span><span class="co">##   .. ..@ factors : list()</span></span>
<span><span class="co">##  $ intercept   : num -455</span></span>
<span><span class="co">##  $ support.size: num 3</span></span>
<span><span class="co">##  $ support.vars: chr [1:3] "job" "education" "region"</span></span>
<span><span class="co">##  $ support.beta: num [1:3] -82.2 -65.2 -63.4</span></span>
<span><span class="co">##  $ dev         : num -505</span></span>
<span><span class="co">##  $ tune.value  : num -101</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimated coefficients</span></span>
<span><span class="va">best.model</span><span class="op">$</span><span class="va">beta</span></span></code></pre></div>
<pre><code><span><span class="co">## 6 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##                   3</span></span>
<span><span class="co">## age         .      </span></span>
<span><span class="co">## sex         .      </span></span>
<span><span class="co">## job       -82.23064</span></span>
<span><span class="co">## education -65.20971</span></span>
<span><span class="co">## region    -63.44148</span></span>
<span><span class="co">## marriage    .</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jin Zhu, Zezhi Wang, Liyuan Hu, Junhao Huang, Kangkang Jiang, Yanhang Zhang, Borui Tang, Shiyun Lin, Junxian Zhu, Canhong Wen, Heping Zhang, Xueqin Wang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'd32715b0e35635336aba6377dd751e21',
    indexName: 'abess',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
