<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Robust Principal Component Analysis • abess</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Robust Principal Component Analysis">
<meta property="og:description" content="abess">
<meta property="og:image" content="https://abess-team.github.io/abess/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">abess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v01-abess-guide.html">Quick start for `abess`: Linear regression</a>
    </li>
    <li>
      <a href="../articles/v03-classification.html">Classification: Logistic Regression and Multinomial Extension</a>
    </li>
    <li>
      <a href="../articles/v04-PoissonGammaReg.html">Positive response: Poisson and Gamma regression</a>
    </li>
    <li>
      <a href="../articles/v05-coxreg.html">Best Subset Selection for Censored Response</a>
    </li>
    <li>
      <a href="../articles/v06-MultiTaskLearning.html">Multi-Response Linear Regression</a>
    </li>
    <li>
      <a href="../articles/v07-advancedFeatures.html">Advanced Features</a>
    </li>
    <li>
      <a href="../articles/v08-sPCA.html">Principal component analysis</a>
    </li>
    <li>
      <a href="../articles/v09-fasterSetting.html">Tips for faster computation</a>
    </li>
    <li>
      <a href="../articles/v10-algorithm.html">ABESS algorithm: details</a>
    </li>
    <li>
      <a href="../articles/v11-power-of-abess.html">Power of abess</a>
    </li>
    <li>
      <a href="../articles/v12-Robust-Principal-Component-Analysis.html">Robust Principal Component Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/abess-team/abess/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v12-Robust-Principal-Component-Analysis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Robust Principal Component Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/abess-team/abess/tree/master/R-package/../vignettes/v12-Robust-Principal-Component-Analysis.Rmd" class="external-link"><code>../vignettes/v12-Robust-Principal-Component-Analysis.Rmd</code></a></small>
      <div class="hidden name"><code>v12-Robust-Principal-Component-Analysis.Rmd</code></div>

    </div>

    
    
<p>This vignette introduces what is adaptive best subset selection robust principal component analysis and then we will show how it works using <em>abess</em> package on an artificial example.</p>
<div class="section level2">
<h2 id="pca">PCA<a class="anchor" aria-label="anchor" href="#pca"></a>
</h2>
<p>Principal component analysis (PCA) is an important method in the field of data science, which can reduce the dimension of data and simplify our model. It solves an optimization problem like:</p>
<p><span class="math display">\[
\max_v v^T \Sigma v, \quad s.t.\  v^Tv=1
\]</span> where <span class="math inline">\(\Sigma = X^TX/(n-1)\)</span> and <span class="math inline">\(X\in \mathbb{R}^{n\times p}\)</span> is the centered sample matrix with each row containing one observation of <span class="math inline">\(p\)</span> variables.</p>
</div>
<div class="section level2">
<h2 id="robust-pca-rpca">Robust-PCA (RPCA)<a class="anchor" aria-label="anchor" href="#robust-pca-rpca"></a>
</h2>
<p>However, the original PCA is sensitive to outliers, which may be unavoidable in real data:</p>
<ul>
<li><p>Object has extreme performance due to fortuity, but he/she shows normal in repeated tests;</p></li>
<li><p>Wrong observation/recording/computing, e.g. missing or dead pixels, X-ray spikes.</p></li>
</ul>
<p>In these situations, PCA may spend too much attention on unnecessary variables. That’s why Robust-PCA (RPCA) is presented, which can be used to recover the (low-rank) sample for subsequent processing.</p>
<p>In mathematics, RPCA manages to divide the sample matrix <span class="math inline">\(X\)</span> into two parts: <span class="math display">\[
X=S+L,
\]</span> where <span class="math inline">\(S\)</span> is the sparse “outlier” matrix and <span class="math inline">\(L\)</span> is the “information” matrix with a low rank. Generally, we also suppose <span class="math inline">\(S\)</span> is not low-rank and <span class="math inline">\(L\)</span> is not sparse, in order to get the unique solution.</p>
<p><img src="https://raw.githubusercontent.com/abess-team/abess/master/docs/Tutorial/fig/rpca.png" width="70%" height="70%"></p>
<p>In Lagrange format, <span class="math display">\[
\min _{S, L}\|X-S-L\|_{F} \leq \varepsilon, s . t . \quad \operatorname{rank}(L)=r,\|S\|_{0} \leq s
\]</span> where <span class="math inline">\(s\)</span> is the sparsity of <span class="math inline">\(S\)</span>. After RPCA, the information matrix <span class="math inline">\(L\)</span> can be used in further analysis.</p>
<p>Note that it does NOT deal with “noise”, which may stay in <span class="math inline">\(L\)</span> and need further procession.</p>
</div>
<div class="section level2">
<h2 id="hard-impute">Hard Impute<a class="anchor" aria-label="anchor" href="#hard-impute"></a>
</h2>
<p>To solve its sub-problem, RPCA with known outlier positions, we follow a process called “Hard Impute”. The main idea is to estimate the outlier values by precise values with KPCA, where <span class="math inline">\(K=r\)</span>.</p>
<p>Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>Input <span class="math inline">\(X\)</span>, <code>outliers</code>, <span class="math inline">\(M, \varepsilon\)</span>, where outliers record the non-zero positions in <span class="math inline">\(S\)</span>;</li>
<li>Denote <span class="math inline">\(X_{n e w} \leftarrow \mathbf{0}\)</span> with the same shape of <span class="math inline">\(X\)</span>;</li>
<li>For <span class="math inline">\(i=1,2, \ldots, M\)</span>
</li>
</ol>
<ul>
<li><span class="math inline">\(X_{o l d}=\left\{\begin{array}{ll}X_{\text {new }}, &amp; \text { for outliers } \\ X, &amp; \text { for others }\end{array}\right.\)</span></li>
<li>Form KPCA on <span class="math inline">\(X_{o l d}\)</span> with <span class="math inline">\(K=r\)</span>, and denote <span class="math inline">\(v\)</span> as the eigenvectors;</li>
<li>
<span class="math inline">\(X_{\text {new }}=X_{\text {old }} \cdot v \cdot v^{T}\)</span>;</li>
<li>If <span class="math inline">\(\left\|X_{n e w}-X_{o l d}\right\|&lt;\varepsilon\)</span>, break: End for;</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Return <span class="math inline">\(X_{\text {new }}\)</span> as <span class="math inline">\(L\)</span>; where <span class="math inline">\(M\)</span> is the maximum iteration times and <span class="math inline">\(\varepsilon\)</span> is the convergence coefficient.</li>
</ol>
<p>The final <span class="math inline">\(X_{\text {new }}\)</span> is supposed to be <span class="math inline">\(L\)</span> under given outlier positions.</p>
</div>
<div class="section level2">
<h2 id="rpca-application">RPCA Application<a class="anchor" aria-label="anchor" href="#rpca-application"></a>
</h2>
<p>Recently, RPCA is more widely used, for example,</p>
<ul>
<li><p>Video Decomposition: in a surveillance video, the background may be unchanged for a long time while only a few pixels (e.g. people) update. In order to improve the efficiency of store and analysis, we need to decomposite the video into background and foreground. Since the background is unchanged, it can be stored well in a low-rank matrix, while the foreground, which is usually quite small, can be indicated by a sparse matrix. That is what RPCA does.</p></li>
<li><p>Face recognition: due to complex lighting conditions, a small part of the facial features may be unrecognized (e.g. shadow). In face recognition, we need to remove the effects of shadows and focus on the face data. Actually, since the face data is almost unchanged (for one person), and the shadows affect only a small part, it is also a suitable situation to use RPCA. Here are some examples:</p></li>
</ul>
<p><img src="https://raw.githubusercontent.com/abess-team/abess/master/docs/Tutorial/fig/rpca_shadow.png" width="70%" height="70%"></p>
</div>
<div class="section level2">
<h2 id="simulated-data-example">Simulated Data Example<a class="anchor" aria-label="anchor" href="#simulated-data-example"></a>
</h2>
<div class="section level3">
<h3 id="fitting-model">Fitting model<a class="anchor" aria-label="anchor" href="#fitting-model"></a>
</h3>
<p>Simulated Data Example Fitting model Now we generate an example with 100 rows and 100 columns with 200 outliers. We are looking forward to recover it with a low rank 10.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/abess-team/abess" class="external-link">abess</a></span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>     <span class="co"># rows</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">100</span>     <span class="co"># columns</span>
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">200</span>     <span class="co"># outliers</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">10</span>      <span class="co"># rank(L)</span>

<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.matrix.html">generate.matrix</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">r</span>, <span class="va">s</span><span class="op">)</span></code></pre></div>
<p>In order to use our program, users should call <code>abessrpca</code> with a given outlier number <code>support_size</code> or an integer interval. For the latter case, a support size will be chosen by information criterion (e.g. GIC) adaptively. <code>abessrpca</code> will return a <code>abessrpca</code> object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res.srpca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abessrpca.html">abessrpca</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span>, <span class="va">dat</span><span class="op">$</span><span class="va">rank</span>, support.size <span class="op">=</span> <span class="va">s</span><span class="op">)</span></code></pre></div>
<p>To extract the estimated coefficients from a fitted <code>abessrpca</code> object, we use the <code>coef</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">res.srpca</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="more-on-the-result">More on the result<a class="anchor" aria-label="anchor" href="#more-on-the-result"></a>
</h3>
<p>To check the performance of the program, we use TPR, FPR as the criterion.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test.model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pred</span>, <span class="va">real</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">tpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">!=</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">real</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">real</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="va">fpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">!=</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">real</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">real</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>tpr <span class="op">=</span> <span class="va">tpr</span>, fpr <span class="op">=</span> <span class="va">fpr</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">test.model</span><span class="op">(</span><span class="va">res.srpca</span><span class="op">$</span><span class="va">S</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">dat</span><span class="op">$</span><span class="va">S</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         tpr         fpr </span>
<span class="co">## 0.835000000 0.003367347</span></code></pre>
<p>We can also change different random seeds to test for more situations:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">30</span>
<span class="va">res.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.matrix.html">generate.matrix</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">r</span>, <span class="va">s</span>, seed <span class="op">=</span> <span class="va">i</span><span class="op">)</span>
  <span class="va">res.srpca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abessrpca.html">abessrpca</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span>, <span class="va">dat</span><span class="op">$</span><span class="va">rank</span>, support.size <span class="op">=</span> <span class="va">s</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">test.model</span><span class="op">(</span><span class="va">res.srpca</span><span class="op">$</span><span class="va">S</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">dat</span><span class="op">$</span><span class="va">S</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">simplify2array</a></span><span class="op">(</span><span class="va">res.test</span><span class="op">)</span><span class="op">)</span>  </code></pre></div>
<pre><code><span class="co">##         tpr         fpr </span>
<span class="co">## 0.839000000 0.003285714</span></code></pre>
<p>Under all of these situations, abessRPCA has a good performance.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jin Zhu, Liyuan Hu, Junhao Huang, Kangkang Jiang, Yanhang Zhang, Zezhi Wang, Borui Tang, Shiyun Lin, Junxian Zhu, Canhong Wen, Heping Zhang, Xueqin Wang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'd32715b0e35635336aba6377dd751e21',
    indexName: 'abess',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
