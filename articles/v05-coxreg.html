<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Best Subset Selection for Censored Response • abess</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Best Subset Selection for Censored Response">
<meta property="og:description" content="abess">
<meta property="og:image" content="https://abess-team.github.io/abess/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">abess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v01-abess-guide.html">Quick start for `abess`: Linear regression</a>
    </li>
    <li>
      <a href="../articles/v03-classification.html">Classification: Logistic Regression and Multinomial Extension</a>
    </li>
    <li>
      <a href="../articles/v04-PoissonGammaReg.html">Positive response: Poisson and Gamma regression</a>
    </li>
    <li>
      <a href="../articles/v05-coxreg.html">Best Subset Selection for Censored Response</a>
    </li>
    <li>
      <a href="../articles/v06-MultiTaskLearning.html">Multi-Response Linear Regression</a>
    </li>
    <li>
      <a href="../articles/v07-advancedFeatures.html">Advanced Features</a>
    </li>
    <li>
      <a href="../articles/v08-sPCA.html">Principal component analysis</a>
    </li>
    <li>
      <a href="../articles/v09-fasterSetting.html">Tips for faster computation</a>
    </li>
    <li>
      <a href="../articles/v10-algorithm.html">ABESS algorithm: details</a>
    </li>
    <li>
      <a href="../articles/v11-power-of-abess.html">Power of abess</a>
    </li>
    <li>
      <a href="../articles/v12-Robust-Principal-Component-Analysis.html">Robust Principal Component Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/abess-team/abess/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v05-coxreg_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Best Subset Selection for Censored Response</h1>
                        <h4 data-toc-skip class="author">Liyuan Hu, Jin Zhu</h4>
            
            <h4 data-toc-skip class="date">2021/5/27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/abess-team/abess/tree/master/R-package/../vignettes/v05-coxreg.Rmd" class="external-link"><code>../vignettes/v05-coxreg.Rmd</code></a></small>
      <div class="hidden name"><code>v05-coxreg.Rmd</code></div>

    </div>

    
    
<!-- In this vignette, a lung cancer dataset is first displayed to the  -->
<!-- ## Lung Cancer Dataset -->
<!-- Let's have a look on the lung cancer dataset collected North Central Cancer Treatment Group (NCCTG).  -->
<!-- This dataset consists of survival information of patients with advanced lung cancer from the NCCTG.  -->
<!-- ```{r} -->
<!-- lung <- read.csv("lung.csv", header = TRUE) -->
<!-- head(lung) -->
<!-- ``` -->
<!-- The second columns -->
<!-- ```{r} -->
<!-- sum(is.na(lung)) -->
<!-- ``` -->
<!-- The proportional hazards model allows the analysis of survival data by regression modeling. -->
<!-- Linearity is assumed on the log scale of the hazard. The hazard ratio in Cox proportional hazard model -->
<!--  is assumed constant. First, we load the data.  -->
<div class="section level2">
<h2 id="cox-proportional-hazards-regression">Cox Proportional Hazards Regression<a class="anchor" aria-label="anchor" href="#cox-proportional-hazards-regression"></a>
</h2>
<p>Cox Proportional Hazards (CoxPH) regression is to describe the survival according to several covariates. The difference between CoxPH regression and Kaplan-Meier curves or the logrank tests is that the latter only focus on modeling the survival according to one factor (categorical predictor is best) while the former is able to take into consideration any covariates simultaneously, regardless of whether they’re quantitative or categorical. The model is as follow: <span class="math display">\[
h(t) = h_0(t)\exp(\eta).
\]</span> where,</p>
<ul>
<li><span class="math inline">\(\eta = x\boldsymbol\beta.\)</span></li>
<li>
<span class="math inline">\(t\)</span> is the survival time.</li>
<li>
<span class="math inline">\(h(t)\)</span> is the hazard function which evaluate the risk of dying at time <span class="math inline">\(t\)</span>.</li>
<li>
<span class="math inline">\(h_0(t)\)</span> is called the baseline hazard. It describes value of the hazard if all the predictors are zero.</li>
<li>
<span class="math inline">\(\boldsymbol\beta\)</span> measures the impact of covariates.</li>
</ul>
<p>Consider two case <span class="math inline">\(i\)</span> and <span class="math inline">\(i'\)</span> that have different x values. Their hazard functions can be simply written as follow</p>
<p><span class="math display">\[
h_i(t) = h_0(t)\exp(\eta_i) = h_0(t)\exp(x_i\boldsymbol\beta)
\]</span> and <span class="math display">\[
h_{i'}(t) = h_0(t)\exp(\eta_{i'}) = h_0(t)\exp(x_{i'}\boldsymbol\beta).
\]</span> The hazard ratio for these two cases is</p>
<p><span class="math display">\[\begin{align*}
\frac{h_i(t)}{h_{i'}(t)} &amp; = \frac{h_0(t)\exp(\eta_i)}{h_0(t)\exp(\eta_{i'})} \\
                         &amp; = \frac{\exp(\eta_i)}{\exp(\eta_{i'})}
\end{align*}\]</span></p>
<p>which is independent of time.</p>
</div>
<div class="section level2">
<h2 id="lung-cancer-dataset">Lung Cancer Dataset<a class="anchor" aria-label="anchor" href="#lung-cancer-dataset"></a>
</h2>
<p>We are going to apply best subset selection to the NCCTG Lung Cancer Dataset. This dataset consists of survival information of patients with advanced lung cancer from the North Central Cancer Treatment Group. The proportional hazards model allows the analysis of survival data by regression modeling. Linearity is assumed on the log scale of the hazard. The hazard ratio in Cox proportional hazard model is assumed constant. First, we load the data</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lung</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"lung.csv"</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lung</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   inst time status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss</span></span>
<span><span class="co">## 1    3  306      2  74   1       1       90       100     1175      NA</span></span>
<span><span class="co">## 2    3  455      2  68   1       0       90        90     1225      15</span></span>
<span><span class="co">## 3    3 1010      1  56   1       0       90        90       NA      15</span></span>
<span><span class="co">## 4    5  210      2  57   1       1       90        60     1150      11</span></span>
<span><span class="co">## 5    1  883      2  60   1       0      100        90       NA       0</span></span>
<span><span class="co">## 6   12 1022      1  74   1       1       50        80      513       0</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">lung</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 67</span></span></code></pre>
<p>Then we remove the rows containing any missing data. After that, we have a total of 167 observations.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lung</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">lung</span><span class="op">)</span></span>
<span><span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">lung</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 167   9</span></span></code></pre>
<p>Then we change the factors into dummy variables with the <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> function. Note that the <code><a href="../reference/abess.html">abess()</a></code> function will automatically include the intercept.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lung</span><span class="op">$</span><span class="va">ph.ecog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">lung</span><span class="op">$</span><span class="va">ph.ecog</span><span class="op">)</span></span>
<span><span class="va">lung</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">.</span>, <span class="va">lung</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>We split the dataset into a training set and a test set. The model is going to be built on the training set and later We will test the model performance on the test set.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">167</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">167</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="best-subset-selection-for-coxph-regression">Best Subset Selection for CoxPH Regression<a class="anchor" aria-label="anchor" href="#best-subset-selection-for-coxph-regression"></a>
</h2>
<p>The <code><a href="../reference/abess.html">abess()</a></code> function in the <code>abess</code> package allows you to perform the best subset selection in a highly efficient way. For CoxPH model, the survival information should be passed to <code>y</code> as a matrix with the first column storing the observed time and the second the status. The covariates should be passed to <code>x</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/abess-team/abess" class="external-link">abess</a></span><span class="op">)</span></span>
<span><span class="va">abess_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abess.html">abess</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, family <span class="op">=</span> <span class="st">"cox"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interpret-the-result">Interpret the Result<a class="anchor" aria-label="anchor" href="#interpret-the-result"></a>
</h2>
<p>After getting the estimator, we can further do more exploring work. The output of <code><a href="../reference/abess.html">abess()</a></code> function contains the best model for all the candidate support size in the <code>support.size</code>. You can use some generic function to quickly draw some information of those estimators.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw the estimated coefficients on all candidate support size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 x 10 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##                                                                      </span></span>
<span><span class="co">## (intercept) . .          .          .          .           .         </span></span>
<span><span class="co">## age         . .          .          .          .           .         </span></span>
<span><span class="co">## sex         . .         -0.3158899 -0.3056507 -0.31215218 -0.37217880</span></span>
<span><span class="co">## ph.ecog1    . .          .          .          .           0.43339436</span></span>
<span><span class="co">## ph.ecog2    . 0.6198472  0.6356454  0.6485150  0.90762608  1.39697310</span></span>
<span><span class="co">## ph.ecog3    . .          .          1.5289436  1.85001630  2.38783028</span></span>
<span><span class="co">## ph.karno    . .          .          .          0.01230716  0.02223652</span></span>
<span><span class="co">## pat.karno   . .          .          .          .           .         </span></span>
<span><span class="co">## meal.cal    . .          .          .          .           .         </span></span>
<span><span class="co">## wt.loss     . .          .          .          .           .         </span></span>
<span><span class="co">##                                                                 </span></span>
<span><span class="co">## (intercept)  .            .            .            .           </span></span>
<span><span class="co">## age          .            .            0.009612417  0.0087629301</span></span>
<span><span class="co">## sex         -0.398257611 -0.400263398 -0.405046539 -0.4176205102</span></span>
<span><span class="co">## ph.ecog1     0.492850038  0.498563852  0.544978560  0.5487891976</span></span>
<span><span class="co">## ph.ecog2     1.548225079  1.421509544  1.426897301  1.4056078686</span></span>
<span><span class="co">## ph.ecog3     2.546825864  2.496377201  2.499743506  2.5323174307</span></span>
<span><span class="co">## ph.karno     0.022739460  0.024257824  0.026461316  0.0266012605</span></span>
<span><span class="co">## pat.karno    .           -0.008454919 -0.008258875 -0.0076750436</span></span>
<span><span class="co">## meal.cal     .            .            .           -0.0001728139</span></span>
<span><span class="co">## wt.loss     -0.008638164 -0.010134095 -0.009558614 -0.0097602080</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the deviance of the estimated model on all candidate support size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 798.3509 791.3829 788.9978 787.5387 785.8258 783.7560 782.4605 781.7364</span></span>
<span><span class="co">##  [9] 781.1942 780.8985</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the fitted model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">abess_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Call:</span></span>
<span><span class="co">## abess.default(x = train[, -(1:2)], y = train[, 1:2], family = "cox")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    support.size      dev      GIC</span></span>
<span><span class="co">## 1             0 798.3509 1596.702</span></span>
<span><span class="co">## 2             1 791.3829 1586.171</span></span>
<span><span class="co">## 3             2 788.9978 1584.805</span></span>
<span><span class="co">## 4             3 787.5387 1585.292</span></span>
<span><span class="co">## 5             4 785.8258 1585.271</span></span>
<span><span class="co">## 6             5 783.7560 1584.536</span></span>
<span><span class="co">## 7             6 782.4605 1585.350</span></span>
<span><span class="co">## 8             7 781.7364 1587.306</span></span>
<span><span class="co">## 9             8 781.1942 1589.627</span></span>
<span><span class="co">## 10            9 780.8985 1592.440</span></span></code></pre>
<p>The <code><a href="../reference/plot.abess.html">plot.abess()</a></code> function helps to visualize the change of models with the change of support size. There are 5 types of graph you can generate, including <code>coef</code> for the coefficient value, <code>l2norm</code> for the L2-norm of the coefficients, <code>dev</code> for the deviance and <code>tune</code> for the tuning value.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span>, label<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="v05-coxreg_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>The graph shows that, beginning from the most dense model, the 4th variable (<code>ph.ecog2</code>) is included in the active set until the support size reaches 0.</p>
<p>We can also generate a graph about the tuning value. Remember that we used the default GIC to tune the support size.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abess_fit</span>, type<span class="op">=</span><span class="st">"tune"</span><span class="op">)</span></span></code></pre></div>
<p><img src="v05-coxreg_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The tuning value reaches the lowest point at 5. And We might choose the estimated model with support size equals 5 as our final model.</p>
<p>To extract the specified model from the <code>abess</code> object, we can call the <code><a href="../reference/extract.abess.html">extract()</a></code> function with a given <code>support.size</code>. If <code>support.size</code> is not provided, the model with the best tuning value will be returned. Here we extract the model with support size equals 6.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best.model</span> <span class="op">=</span> <span class="fu"><a href="../reference/extract.abess.html">extract</a></span><span class="op">(</span><span class="va">abess_fit</span>, support.size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">best.model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 7</span></span>
<span><span class="co">##  $ beta        :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span></span>
<span><span class="co">##   .. ..@ i       : int [1:5] 1 2 3 4 5</span></span>
<span><span class="co">##   .. ..@ p       : int [1:2] 0 5</span></span>
<span><span class="co">##   .. ..@ Dim     : int [1:2] 9 1</span></span>
<span><span class="co">##   .. ..@ Dimnames:List of 2</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:9] "age" "sex" "ph.ecog1" "ph.ecog2" ...</span></span>
<span><span class="co">##   .. .. ..$ : chr "5"</span></span>
<span><span class="co">##   .. ..@ x       : num [1:5] -0.3722 0.4334 1.397 2.3878 0.0222</span></span>
<span><span class="co">##   .. ..@ factors : list()</span></span>
<span><span class="co">##  $ intercept   : num 0</span></span>
<span><span class="co">##  $ support.size: num 5</span></span>
<span><span class="co">##  $ support.vars: chr [1:5] "sex" "ph.ecog1" "ph.ecog2" "ph.ecog3" ...</span></span>
<span><span class="co">##  $ support.beta: num [1:5] -0.3722 0.4334 1.397 2.3878 0.0222</span></span>
<span><span class="co">##  $ dev         : num 784</span></span>
<span><span class="co">##  $ tune.value  : num 1585</span></span></code></pre>
<p>The return is a list containing the basic information of the estimated model.</p>
</div>
<div class="section level2">
<h2 id="make-a-prediction">Make a Prediction<a class="anchor" aria-label="anchor" href="#make-a-prediction"></a>
</h2>
<p>Prediction is allowed for all the estimated model. Just call <code><a href="../reference/predict.abess.html">predict.abess()</a></code> function with the <code>support.size</code> set to the size of model you are interested in. If a <code>support.size</code> is not provided, prediction will be made on the model with best tuning value. The <code><a href="../reference/predict.abess.html">predict.abess()</a></code> can provide both <code>link</code>, standing for the linear predictors, and the <code>response</code>, standing for the fitted relative-risk. Here We will predict fitted relative-risk on the test data.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitted.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">abess_fit</span>, newx <span class="op">=</span> <span class="va">test</span>, type <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span></code></pre></div>
<p>We now calculate the C-index, i.e., the probability that, for a pair of randomly chosen comparable samples, the sample with the higher risk prediction will experience an event before the other sample or belong to a higher binary class. On this dataset, the C-index is 0.64.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/" class="external-link">Hmisc</a></span><span class="op">)</span></span>
<span><span class="va">Cindex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/rcorr.cens.html" class="external-link">rcorr.cens</a></span><span class="op">(</span><span class="va">fitted.results</span>, <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">test</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/rcorr.cens.html" class="external-link">rcorr.cens</a></span><span class="op">(</span><span class="va">fitted.results</span>, <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">test</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Cindex</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6422652</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jin Zhu, Liyuan Hu, Junhao Huang, Kangkang Jiang, Yanhang Zhang, Zezhi Wang, Borui Tang, Shiyun Lin, Junxian Zhu, Canhong Wen, Heping Zhang, Xueqin Wang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'd32715b0e35635336aba6377dd751e21',
    indexName: 'abess',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
